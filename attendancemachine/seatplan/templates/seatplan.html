<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Room Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ================= GLOBAL ================= */
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#0f172a,#020617);
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  color:#fff;
}
.container{
  max-width:420px;
  margin:auto;
  padding:16px;
}

/* ================= HEADER ================= */
h1{
  text-align:center;
  font-size:20px;
  margin:8px 0 14px;
}

/* ================= CONTROLS ================= */
.controls{
  display:grid;
  grid-template-columns:1fr 2fr;
  gap:10px;
  margin-bottom:14px;
}
.btn{
  height:38px;
  border-radius:999px;
  border:none;
  font-weight:600;
  cursor:pointer;
}
.btn-today{background:#1f2937;color:#fff}
.btn-date{
  background:#0b5cff;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 14px;
}

/* ================= SUMMARY ================= */
.summary{
  background:linear-gradient(135deg,#0b5cff,#2f7bf6);
  border-radius:18px;
  padding:14px;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  text-align:center;
  margin-bottom:10px;
}
.summary span{font-size:11px;opacity:.85}
.summary b{font-size:22px;display:block;margin-top:4px}

/* ================= LEGEND ================= */
.legend{
  display:flex;
  justify-content:center;
  gap:16px;
  font-size:12px;
  margin-bottom:14px;
}
.legend i{
  width:12px;height:12px;border-radius:50%;display:inline-block;margin-right:6px;
}
.l-present{background:#16a34a}
.l-coming{background:#2563eb}
.l-leave{background:#ef4444}

/* ================= LAYOUT ================= */
.room{
  display:grid;
  grid-template-columns:1fr 160px;
  gap:14px;
}
.tables{
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* ================= TABLE BOX ================= */
.table{
  border:2px solid #ef4444;
  border-radius:16px;
  padding:14px;
  display:grid;
  gap:14px;
}

/* ================= GRIDS ================= */
.row3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.row2x3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.row4{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}

/* ================= SEAT ================= */
.seat{
  height:64px; /* ✅ Nazim size */
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:12px;
  font-weight:600;
  cursor:pointer;
  position:relative;
  transition:transform .2s ease,box-shadow .2s ease;
}
.seat:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 18px rgba(0,0,0,.5);
}

/* COLORS */
.present{background:#16a34a;color:#fff}
.coming{background:#2563eb;color:#fff}
.leave{background:#ef4444;color:#fff}

/* ================= TOOLTIP ================= */
.seat::after{
  content:attr(data-status);
  position:absolute;
  bottom:72px;
  left:50%;
  transform:translateX(-50%);
  background:#fff;
  color:#000;
  font-size:11px;
  padding:4px 8px;
  border-radius:6px;
  white-space:nowrap;
  opacity:0;
  pointer-events:none;
  transition:.15s ease;
  z-index:9999;
}
.seat:hover::after{opacity:1}

/* ================= GATE ================= */
.gate{
  border:2px solid #ef4444;
  border-radius:16px;
  padding:14px;

  /* ✅ title + 3 seats (nazim size) + router text */
  display:grid;
  grid-template-rows:auto repeat(3, 64px) auto;
  gap:14px;
}
.gate-title{
  text-align:center;
  font-size:13px;
  opacity:.8;
}
.router-title{
  text-align:center;
  font-size:13px;
  opacity:.8;
}

/* ================= RESPONSIVE ================= */
@media(min-width:768px){
  .container{max-width:520px}
}
</style>
</head>

<body>
<div class="container">

<h1>Room Map</h1>

<div class="controls">
  <button class="btn btn-today" id="btnToday">Today</button>
  <div class="btn btn-date">
    <span id="btnPrev">◀</span>
    <span id="dateLabel"></span>
    <span id="btnNext">▶</span>
  </div>
</div>

<div class="summary">
  <div><span>PRESENT</span><b id="countPresent">0</b></div>
  <div><span>COMING</span><b id="countComing">0</b></div>
  <div><span>LEAVE</span><b id="countLeave">0</b></div>
</div>

<div class="legend">
  <div><i class="l-present"></i>Present</div>
  <div><i class="l-coming"></i>Coming</div>
  <div><i class="l-leave"></i>Leave</div>
</div>

<div class="room">

  <div class="tables">

    <div class="table">
      <div class="seat" data-seat="teacher"></div>
      <div class="row3">
        <div class="seat" data-seat="nazim"></div>
        <div class="seat" data-seat="shohel_top"></div>
        <div class="seat" data-seat="shafeen"></div>
      </div>
    </div>

    <div class="table">
      <div class="row2x3">
        <div class="seat" data-seat="yunus"></div>
        <div class="seat" data-seat="muzahid"></div>
        <div class="seat" data-seat="tonmoy"></div>
        <div class="seat" data-seat="jamil"></div>
        <div class="seat" data-seat="imran"></div>
        <div class="seat" data-seat="mahi"></div>
      </div>
    </div>

    <div class="table">
      <div class="row4">
        <div class="seat" data-seat="monir"></div>
        <div class="seat" data-seat="sohel_bottom"></div>
        <div class="seat" data-seat="nafisa"></div>
        <div class="seat" data-seat="tasfia"></div>
      </div>
    </div>

  </div>

  <div class="gate">
    <div class="gate-title">Gate</div>

    <div class="seat" data-seat="shawon"></div>
    <div class="seat" data-seat="empty"></div>
    <div class="seat" data-seat="rahad"></div>
    <br>

    <!-- ✅ Router is text like Gate (not a seat) -->
    <div class="router-title">Router</div>
  </div>

</div>
</div>

<script>
const API="/api/seatplan/";
let current=new Date();

function fmt(d){return d.toISOString().slice(0,10)}

function applySeat(seat){
  const el=document.querySelector(`[data-seat="${seat.id}"]`);
  if(!el) return;

  el.className="seat";
  el.textContent=seat.label;

  if(seat.status==="present"){
    el.classList.add("present");
    el.dataset.status="Present";
  }else if(seat.status==="leave"){
    el.classList.add("leave");
    el.dataset.status="Leave";
  }else{
    el.classList.add("coming");
    el.dataset.status="Coming";
  }
}

async function load(){
  const date=fmt(current);
  dateLabel.textContent=date;

  const r=await fetch(`${API}?date=${date}`);
  const d=await r.json();

  countPresent.textContent=d.summary.green;
  countComing.textContent=d.summary.yellow;
  countLeave.textContent=d.summary.red;

  d.seats.forEach(applySeat);
}

btnToday.onclick=()=>{current=new Date();load()}
btnPrev.onclick=()=>{current.setDate(current.getDate()-1);load()}
btnNext.onclick=()=>{current.setDate(current.getDate()+1);load()}

load();
</script>

</body>
</html>
